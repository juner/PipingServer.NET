<html>
<head>
  <title>Piping</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    h3 {
      margin-top: 2em;
      margin-bottom: 0.5em;
    }
  </style>
</head>
<body>
  <h1>Piping</h1>
  Streaming Data Transfer Server over HTTP/HTTPS
  <form method="POST" id="file_form" enctype="multipart/form-data">
    <h3>Step 1: Choose a file or text</h3>

    <input type="checkbox" id="inputMode" onchange="toggleInputMode()">: <b>Text mode</b><br><br>

    <input type="file" name="input_file">
    <textarea type="text" name="input_text" placeholder="Input text" cols="30" rows="10"></textarea>
    <br>

    <h3>Step 2: Write your secret path</h3>
    (e.g. "abcd1234", "mysecret.png?n=3")<br>
    <input id="secret_path" placeholder="Secret path" size="50"><br>
    <h3>Step 3: Click the submit button</h3>
    <input type="submit">
  </form>
  <hr>
  Command-line usage:
  <a href="https://github.com/nwtgck/piping-server#readme">
    https://github.com/nwtgck/piping-server#readme
  </a><br>
  <script>
    // Set secret path action routing
    (function () {
      var fileForm = document.getElementById("file_form");
      var secretPathInput = document.getElementById("secret_path");
      secretPathInput.onkeyup = function(){
        fileForm.action = "./" + secretPathInput.value;
      };
    })();

    // Toggle input mode: file or text
    var toggleInputMode = (function () {
      var fileInput   = document.getElementsByName("input_file")[0];
      var textInput   = document.getElementsByName("input_text")[0];
      var activeInput = fileInput;
      var deactivatedInput = textInput;

      // Set inputs' functionality and visibility
      function setInputs() {
        activeInput.removeAttribute("disabled");
        activeInput.style.removeProperty("display");

        deactivatedInput.setAttribute("disabled", "");
        deactivatedInput.style.display = "none";
      }
      setInputs();

      // Body of toggleInputMode
      function toggle() {
        // Swap inputs
        var tmpInput     = activeInput;
        activeInput      = deactivatedInput;
        deactivatedInput = tmpInput;
        setInputs();
      }
      return toggle;
    })();
  </script>
</body>
</html>